Updated the code, added the graphics